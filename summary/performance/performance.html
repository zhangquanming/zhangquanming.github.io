<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>编码优化 | 全明笔记</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="张全明的个人笔记">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.484694f3.css" as="style"><link rel="preload" href="/assets/js/app.07d4e7d8.js" as="script"><link rel="preload" href="/assets/js/2.e756895e.js" as="script"><link rel="preload" href="/assets/js/36.4643cf1b.js" as="script"><link rel="prefetch" href="/assets/js/10.9dcd3981.js"><link rel="prefetch" href="/assets/js/11.7c3a4891.js"><link rel="prefetch" href="/assets/js/12.9123d821.js"><link rel="prefetch" href="/assets/js/13.dc2b3bbc.js"><link rel="prefetch" href="/assets/js/14.8e9572dd.js"><link rel="prefetch" href="/assets/js/15.0831d9fb.js"><link rel="prefetch" href="/assets/js/16.fff0091e.js"><link rel="prefetch" href="/assets/js/17.13d701e1.js"><link rel="prefetch" href="/assets/js/18.c01d73d7.js"><link rel="prefetch" href="/assets/js/19.6d8da221.js"><link rel="prefetch" href="/assets/js/20.7e3bfbe7.js"><link rel="prefetch" href="/assets/js/21.d67b0029.js"><link rel="prefetch" href="/assets/js/22.a1d1221b.js"><link rel="prefetch" href="/assets/js/23.97f7c972.js"><link rel="prefetch" href="/assets/js/24.f25bbb61.js"><link rel="prefetch" href="/assets/js/25.886c2813.js"><link rel="prefetch" href="/assets/js/26.d354a60e.js"><link rel="prefetch" href="/assets/js/27.8165f251.js"><link rel="prefetch" href="/assets/js/28.38db902f.js"><link rel="prefetch" href="/assets/js/29.d089321c.js"><link rel="prefetch" href="/assets/js/3.c090ecd3.js"><link rel="prefetch" href="/assets/js/30.7f597fdf.js"><link rel="prefetch" href="/assets/js/31.00125d26.js"><link rel="prefetch" href="/assets/js/32.1b584e55.js"><link rel="prefetch" href="/assets/js/33.b6331f3f.js"><link rel="prefetch" href="/assets/js/34.021e8dad.js"><link rel="prefetch" href="/assets/js/35.2b1e189b.js"><link rel="prefetch" href="/assets/js/37.ff936690.js"><link rel="prefetch" href="/assets/js/4.55092137.js"><link rel="prefetch" href="/assets/js/5.02018b5a.js"><link rel="prefetch" href="/assets/js/6.bd7b0c2a.js"><link rel="prefetch" href="/assets/js/7.711e75c5.js"><link rel="prefetch" href="/assets/js/8.35b709e8.js"><link rel="prefetch" href="/assets/js/9.029996af.js">
    <link rel="stylesheet" href="/assets/css/0.styles.484694f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">全明笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/summary/" class="nav-link router-link-active">
  知识总结
</a></div><div class="nav-item"><a href="/utils/" class="nav-link">
  工具类
</a></div><div class="nav-item"><a href="/links/" class="nav-link">
  学习资料
</a></div><div class="nav-item"><a href="/code/" class="nav-link">
  手写代码
</a></div><div class="nav-item"><a href="https://www.mingme.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zhangquanming/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/summary/" class="nav-link router-link-active">
  知识总结
</a></div><div class="nav-item"><a href="/utils/" class="nav-link">
  工具类
</a></div><div class="nav-item"><a href="/links/" class="nav-link">
  学习资料
</a></div><div class="nav-item"><a href="/code/" class="nav-link">
  手写代码
</a></div><div class="nav-item"><a href="https://www.mingme.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zhangquanming/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>知识总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/" aria-current="page" class="sidebar-link">前言</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/css/base.html" class="sidebar-link">CSS基础知识</a></li><li><a href="/summary/css/layout.html" class="sidebar-link">常见布局方式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript 相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/javascript/" class="sidebar-link">JavaScript基础知识</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器与网络</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/http/web.html" class="sidebar-link">浏览器</a></li><li><a href="/summary/http/service.html" class="sidebar-link">服务端与网络</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/framework/vue.html" class="sidebar-link">Vue</a></li><li><a href="/summary/framework/react.html" class="sidebar-link">React</a></li><li><a href="/summary/framework/Hybrid.html" class="sidebar-link">Hybrid</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>构建工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/bundler/webpack.html" class="sidebar-link">Webpack</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/monitor/monitor.html" class="sidebar-link">前端监控</a></li><li><a href="/summary/performance/performance.html" aria-current="page" class="active sidebar-link">项目性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/summary/performance/performance.html#编码优化" class="sidebar-link">编码优化</a></li><li class="sidebar-sub-header"><a href="/summary/performance/performance.html#页面基础优化" class="sidebar-link">页面基础优化</a></li><li class="sidebar-sub-header"><a href="/summary/performance/performance.html#首屏渲染优化" class="sidebar-link">首屏渲染优化</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>全栈基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/other/node.html" class="sidebar-link">Node</a></li><li><a href="/summary/other/nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/summary/other/docker.html" class="sidebar-link">Docker</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="编码优化"><a href="#编码优化" class="header-anchor">#</a> 编码优化</h2> <p>编码优化，指的就是 在代码编写时的，通过一些最佳实践，提升代码的执行性能。通常这并不会带来非常大的收益，但这属于程序猿的自我修养，而且这也是面试中经常被问到的一个方面，考察自我管理与细节的处理。</p> <ul><li><p><strong>数据读取</strong></p> <ul><li>通过作用域链 / 原型链 读取变量或方法时，需要更多的耗时，且越长越慢</li> <li>对象嵌套越深，读取值也越慢</li> <li><strong>最佳实践</strong> <ul><li>尽量在局部作用域中进行 <strong>变量缓存</strong></li> <li>避免嵌套过深的数据结构，<strong>数据扁平化</strong> 有利于数据的读取和维护</li></ul></li></ul></li> <li><p><strong>循环</strong>: 循环通常是编码性能的关键点</p> <ul><li>代码的性能问题会再循环中被指数倍放大</li> <li><strong>最佳实践</strong> <ul><li>尽可能 <strong>减少循环次数</strong> <ul><li>减少遍历的数据量</li> <li>完成目的后马上结束循环</li></ul></li> <li>避免在循环中执行大量的运算，避免重复计算，相同的执行结果应该使用缓存</li> <li>js 中使用 <strong>倒序循环</strong> 会略微提升性能</li> <li>尽量避免使用 for-in 循环，因为它会枚举原型对象，耗时大于普通循环</li></ul></li></ul></li> <li><p><strong>条件流程性能</strong>: Map / Object &gt; switch &gt; if-else</p></li> <li><p><strong>减少 cookie 体积</strong>: 能有效减少每次请求的体积和响应时间</p> <ul><li>去除不必要的 cookie</li> <li>压缩 cookie 大小</li> <li>设置 domain 与 过期时间</li></ul></li> <li><p><strong>dom 优化</strong></p> <ul><li><strong>减少访问 dom 的次数</strong>，如需多次，将 dom 缓存于变量中</li> <li><strong>减少重绘与回流</strong> <ul><li>多次操作合并为一次</li> <li>减少对计算属性的访问
<ul><li>例如 offsetTop， getComputedStyle 等</li> <li>因为浏览器需要获取最新准确的值，因此必须立即进行重排，这样会破坏了浏览器的队列整合，尽量将值进行缓存使用</li></ul></li> <li>大量操作时，可将 dom 脱离文档流或者隐藏，待操作完成后再重新恢复</li> <li>使用 <code>DocumentFragment</code> / <code>cloneNode</code> / <code>replaceChild</code> 进行操作</li></ul></li> <li>使用事件委托，避免大量的事件绑定</li></ul></li> <li><p><strong>css 优化</strong></p> <ul><li>层级扁平，避免过于多层级的选择器嵌套</li> <li>特定的选择器 好过一层一层查找: .xxx-child-text{} 优于 .xxx .child .text{}</li> <li>减少使用通配符与属性选择器</li> <li>减少不必要的多余属性</li> <li>使用 动画属性 实现动画，动画时脱离文档流，开启硬件加速，优先使用 css 动画</li> <li>使用 <code>&lt;link&gt;</code> 替代原生 @import</li></ul></li> <li><p><strong>html 优化</strong></p> <ul><li>减少 dom 数量，避免不必要的节点或嵌套</li> <li>避免 <code>&lt;img src=&quot;&quot; /&gt;</code> 空标签，能减少服务器压力，因为 src 为空时，浏览器仍然会发起请求
<ul><li>IE 向页面所在的目录发送请求</li> <li>Safari、Chrome、Firefox 向页面本身发送请求</li> <li>Opera 不执行任何操作</li></ul></li> <li>图片提前 指定宽高 或者 脱离文档流，能有效减少因图片加载导致的页面回流</li> <li>语义化标签 有利于 SEO 与浏览器的解析时间</li> <li>减少使用 table 进行布局，避免使用 <code>&lt;br /&gt;</code> 与 <code>&lt;hr /&gt;</code></li></ul></li></ul> <h2 id="页面基础优化"><a href="#页面基础优化" class="header-anchor">#</a> 页面基础优化</h2> <ul><li><p><strong>引入位置</strong>: css 文件 <code>&lt;head&gt;</code> 中引入， js 文件 <code>&lt;body&gt;</code> 底部引入</p> <ul><li>影响首屏的，优先级很高的 js 也可以头部引入，甚至内联</li></ul></li> <li><p><strong>减少请求</strong> (http 1.0 - 1.1)，合并请求，正确设置 http 缓存</p></li> <li><p><strong>减少文件体积</strong></p> <ul><li><strong>删除多余代码</strong> <ul><li>tree-shaking</li> <li>UglifyJs</li> <li>code-spliting</li></ul></li> <li><strong>混淆 / 压缩代码</strong>，开启 gzip 压缩</li> <li><strong>多份编译文件按条件引入</strong> <ul><li>针对现代浏览器直接给 ES6 文件，只针对低端浏览器引用编译后的 ES5 文件</li> <li>可以利用 <code>&lt;script type=&quot;module&quot;&gt;</code> / <code>&lt;script type=&quot;module&quot;&gt;</code> 进行条件引入用</li></ul></li> <li><strong>动态 polyfill</strong>，只针对不支持的浏览器引入 polyfill</li></ul></li> <li><p><strong>图片优化</strong></p> <ul><li>根据业务场景，与 UI 探讨选择 <strong>合适质量，合适尺寸</strong></li> <li>根据需求和平台，选择 <strong>合适格式</strong>，例如非透明时可用 jpg；非苹果端，使用 webp</li> <li>小图片合成 <strong>雪碧图</strong>，低于 5K 的图片可以转换成 <strong>base64</strong> 内嵌</li> <li>合适场景下，使用 <strong>iconfont</strong> 或者 <strong>svg</strong></li></ul></li> <li><p><strong>使用缓存</strong></p> <ul><li><strong>浏览器缓存</strong>: 通过设置请求的过期时间，合理运用浏览器缓存</li> <li><strong>CDN 缓存</strong>: 静态文件合理使用 CDN 缓存技术
<ul><li>HTML 放于自己的服务器上</li> <li>打包后的图片 / js / css 等资源上传到 CDN 上，文件带上 hash 值</li> <li>由于浏览器对单个域名请求的限制，可以将资源放在多个不同域的 CDN 上，可以绕开该限制</li></ul></li> <li><strong>服务器缓存</strong>: 将不变的数据、页面缓存到 内存 或 远程存储(redis 等) 上</li> <li><strong>数据缓存</strong>: 通过各种存储将不常变的数据进行缓存，缩短数据的获取时间</li></ul></li></ul> <h2 id="首屏渲染优化"><a href="#首屏渲染优化" class="header-anchor">#</a> 首屏渲染优化</h2> <ul><li><strong>css / js 分割</strong>，使首屏依赖的文件体积最小，内联首屏关键 css / js</li> <li>非关键性的文件尽可能的 <strong>异步加载和懒加载</strong>，避免阻塞首页渲染</li> <li>使用 <code>dns-prefetch</code> / <code>preconnect</code> / <code>prefetch</code> / <code>preload</code> 等浏览器提供的资源提示，加快文件传输</li> <li>谨慎控制好 Web 字体，一个大字体包足够让你功亏一篑
<ul><li>控制字体包的加载时机</li> <li>如果使用的字体有限，那尽可能只将使用的文字单独打包，能有效减少体积</li></ul></li> <li>合理利用 Localstorage / server-worker 等存储方式进行 <strong>数据与资源缓存</strong></li> <li><strong>分清轻重缓急</strong> <ul><li>重要的元素优先渲染</li> <li>视窗内的元素优先渲染</li></ul></li> <li><strong>服务端渲染(SSR)</strong> <ul><li>减少首屏需要的数据量，剔除冗余数据和请求</li> <li>控制好缓存，对数据/页面进行合理的缓存</li> <li>页面的请求使用流的形式进行传递</li></ul></li> <li><strong>优化用户感知</strong> <ul><li>利用一些动画 <strong>过渡效果</strong>，能有效减少用户对卡顿的感知</li> <li>尽可能利用 <strong>骨架屏(Placeholder) / Loading</strong> 等减少用户对白屏的感知</li> <li>动画帧数尽量保证在 <strong>30 帧</strong> 以上，低帧数、卡顿的动画宁愿不要</li> <li>js 执行时间避免超过 <strong>100ms</strong>，超过的话就需要做
<ul><li>寻找可 缓存 的点</li> <li>任务的 分割异步 或 web worker 执行</li></ul></li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/11/2021, 3:06:48 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/summary/monitor/monitor.html" class="prev">
        前端监控
      </a></span> <span class="next"><a href="/summary/other/node.html">
        Node
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.07d4e7d8.js" defer></script><script src="/assets/js/2.e756895e.js" defer></script><script src="/assets/js/36.4643cf1b.js" defer></script>
  </body>
</html>
