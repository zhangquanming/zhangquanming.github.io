<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>http/https 协议 | 全明笔记</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="张全明的个人笔记">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.484694f3.css" as="style"><link rel="preload" href="/assets/js/app.07d4e7d8.js" as="script"><link rel="preload" href="/assets/js/2.e756895e.js" as="script"><link rel="preload" href="/assets/js/29.d089321c.js" as="script"><link rel="prefetch" href="/assets/js/10.9dcd3981.js"><link rel="prefetch" href="/assets/js/11.7c3a4891.js"><link rel="prefetch" href="/assets/js/12.9123d821.js"><link rel="prefetch" href="/assets/js/13.dc2b3bbc.js"><link rel="prefetch" href="/assets/js/14.8e9572dd.js"><link rel="prefetch" href="/assets/js/15.0831d9fb.js"><link rel="prefetch" href="/assets/js/16.fff0091e.js"><link rel="prefetch" href="/assets/js/17.13d701e1.js"><link rel="prefetch" href="/assets/js/18.c01d73d7.js"><link rel="prefetch" href="/assets/js/19.6d8da221.js"><link rel="prefetch" href="/assets/js/20.7e3bfbe7.js"><link rel="prefetch" href="/assets/js/21.d67b0029.js"><link rel="prefetch" href="/assets/js/22.a1d1221b.js"><link rel="prefetch" href="/assets/js/23.97f7c972.js"><link rel="prefetch" href="/assets/js/24.f25bbb61.js"><link rel="prefetch" href="/assets/js/25.886c2813.js"><link rel="prefetch" href="/assets/js/26.d354a60e.js"><link rel="prefetch" href="/assets/js/27.8165f251.js"><link rel="prefetch" href="/assets/js/28.38db902f.js"><link rel="prefetch" href="/assets/js/3.c090ecd3.js"><link rel="prefetch" href="/assets/js/30.7f597fdf.js"><link rel="prefetch" href="/assets/js/31.00125d26.js"><link rel="prefetch" href="/assets/js/32.1b584e55.js"><link rel="prefetch" href="/assets/js/33.b6331f3f.js"><link rel="prefetch" href="/assets/js/34.021e8dad.js"><link rel="prefetch" href="/assets/js/35.2b1e189b.js"><link rel="prefetch" href="/assets/js/36.4643cf1b.js"><link rel="prefetch" href="/assets/js/37.ff936690.js"><link rel="prefetch" href="/assets/js/4.55092137.js"><link rel="prefetch" href="/assets/js/5.02018b5a.js"><link rel="prefetch" href="/assets/js/6.bd7b0c2a.js"><link rel="prefetch" href="/assets/js/7.711e75c5.js"><link rel="prefetch" href="/assets/js/8.35b709e8.js"><link rel="prefetch" href="/assets/js/9.029996af.js">
    <link rel="stylesheet" href="/assets/css/0.styles.484694f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">全明笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/summary/" class="nav-link router-link-active">
  知识总结
</a></div><div class="nav-item"><a href="/utils/" class="nav-link">
  工具类
</a></div><div class="nav-item"><a href="/links/" class="nav-link">
  学习资料
</a></div><div class="nav-item"><a href="/code/" class="nav-link">
  手写代码
</a></div><div class="nav-item"><a href="https://www.mingme.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zhangquanming/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/summary/" class="nav-link router-link-active">
  知识总结
</a></div><div class="nav-item"><a href="/utils/" class="nav-link">
  工具类
</a></div><div class="nav-item"><a href="/links/" class="nav-link">
  学习资料
</a></div><div class="nav-item"><a href="/code/" class="nav-link">
  手写代码
</a></div><div class="nav-item"><a href="https://www.mingme.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zhangquanming/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>知识总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/" aria-current="page" class="sidebar-link">前言</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/css/base.html" class="sidebar-link">CSS基础知识</a></li><li><a href="/summary/css/layout.html" class="sidebar-link">常见布局方式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript 相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/javascript/" class="sidebar-link">JavaScript基础知识</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>浏览器与网络</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/http/web.html" class="sidebar-link">浏览器</a></li><li><a href="/summary/http/service.html" aria-current="page" class="active sidebar-link">服务端与网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/summary/http/service.html#http-https-协议" class="sidebar-link">http/https 协议</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#常见状态码" class="sidebar-link">常见状态码</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#get-post" class="sidebar-link">get / post</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#tcp-三次握手" class="sidebar-link">TCP 三次握手</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#tcp-四次挥手" class="sidebar-link">TCP 四次挥手</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#解决无状态问题" class="sidebar-link">解决无状态问题</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#跨域" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/summary/http/service.html#安全" class="sidebar-link">安全</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/framework/vue.html" class="sidebar-link">Vue</a></li><li><a href="/summary/framework/react.html" class="sidebar-link">React</a></li><li><a href="/summary/framework/Hybrid.html" class="sidebar-link">Hybrid</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>构建工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/bundler/webpack.html" class="sidebar-link">Webpack</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/monitor/monitor.html" class="sidebar-link">前端监控</a></li><li><a href="/summary/performance/performance.html" class="sidebar-link">项目性能优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>全栈基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/other/node.html" class="sidebar-link">Node</a></li><li><a href="/summary/other/nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/summary/other/docker.html" class="sidebar-link">Docker</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="http-https-协议"><a href="#http-https-协议" class="header-anchor">#</a> http/https 协议</h2> <ul><li>1.0 协议缺陷:
<ul><li>无法复用链接，完成即断开，<strong>重新慢启动和 TCP 3 次握手</strong></li> <li>head of line blocking: <strong>线头阻塞</strong>，导致请求之间互相影响</li></ul></li> <li>1.1 改进:
<ul><li><strong>长连接</strong>(默认 keep-alive)，复用</li> <li>host 字段指定对应的虚拟站点</li> <li>新增功能:
<ul><li>断点续传</li> <li>身份认证</li> <li>状态管理</li> <li>cache 缓存
<ul><li>Cache-Control</li> <li>Expires</li> <li>Last-Modified</li> <li>Etag</li></ul></li></ul></li></ul></li> <li>2.0:
<ul><li>多路复用</li> <li>二进制分帧层: 应用层和传输层之间</li> <li>首部压缩</li> <li>服务端推送</li></ul></li> <li>https: 较为安全的网络传输协议
<ul><li>证书(公钥)</li> <li>SSL 加密</li> <li>端口 443</li></ul></li> <li>TCP:
<ul><li>三次握手</li> <li>四次挥手</li> <li>滑动窗口: 流量控制</li> <li>拥塞处理
<ul><li>慢开始</li> <li>拥塞避免</li> <li>快速重传</li> <li>快速恢复</li></ul></li></ul></li> <li>缓存策略: 可分为 <strong>强缓存</strong> 和 <strong>协商缓存</strong> <ul><li>Cache-Control/Expires: 浏览器判断缓存是否过期，未过期时，直接使用强缓存，<strong>Cache-Control 的 max-age 优先级高于 Expires</strong></li> <li>当缓存已经过期时，使用协商缓存
<ul><li>唯一标识方案: Etag(response 携带) &amp; If-None-Match(request 携带，上一次返回的 Etag): 服务器判断资源是否被修改</li> <li>最后一次修改时间: Last-Modified(response) &amp; If-Modified-Since (request，上一次返回的 Last-Modified)
<ul><li>如果一致，则直接返回 304 通知浏览器使用缓存</li> <li>如不一致，则服务端返回新的资源</li></ul></li></ul></li> <li>Last-Modified 缺点：
<ul><li>周期性修改，但内容未变时，会导致缓存失效</li> <li>最小粒度只到 s， s 以内的改动无法检测到</li></ul></li> <li>Etag 的优先级高于 Last-Modified</li></ul></li></ul> <h2 id="常见状态码"><a href="#常见状态码" class="header-anchor">#</a> 常见状态码</h2> <ul><li>1xx: 接受，继续处理</li> <li>200: 成功，并返回数据</li> <li>201: 已创建</li> <li>202: 已接受</li> <li>203: 成为，但未授权</li> <li>204: 成功，无内容</li> <li>205: 成功，重置内容</li> <li>206: 成功，部分内容</li> <li>301: 永久移动，重定向</li> <li>302: 临时移动，可使用原有 URI</li> <li>304: 资源未修改，可使用缓存</li> <li>305: 需代理访问</li> <li>400: 请求语法错误</li> <li>401: 要求身份认证</li> <li>403: 拒绝请求</li> <li>404: 资源不存在</li> <li>500: 服务器错误</li></ul> <h2 id="get-post"><a href="#get-post" class="header-anchor">#</a> get / post</h2> <table><thead><tr><th></th> <th>GET</th> <th>POST</th></tr></thead> <tbody><tr><td>后退按钮/刷新</td> <td>无害</td> <td>数据会被重新提交</td></tr> <tr><td>书签</td> <td>可收藏</td> <td>不可收藏</td></tr> <tr><td>缓存</td> <td>能被缓存</td> <td>不能缓存</td></tr> <tr><td>编码类型</td> <td>appLication/x-www-form-urlencoded</td> <td>appLication/x-www-form-urlencoded 或 multipart/form-data。为二进制数据使用多重编码。</td></tr> <tr><td>历史</td> <td>参数保留在浏览器历史中</td> <td>参数不会保存在浏览器历史中</td></tr> <tr><td>对数据长度限制</td> <td>URL 的最大长度 2048 个字符</td> <td>无限制</td></tr> <tr><td>对数据类型限制</td> <td>只允许 ASCII 字符</td> <td>没有限制，也允许二进制数据。</td></tr> <tr><td>安全性</td> <td>相对较差，所发送的数据是 URL 的一部分</td> <td>相对较安全，参数不会被保存在浏览器历史</td></tr> <tr><td>可见性</td> <td>数据在 URL 中所有人都是可见的</td> <td>数据不会显示在 URL 中</td></tr></tbody></table> <h2 id="tcp-三次握手"><a href="#tcp-三次握手" class="header-anchor">#</a> TCP 三次握手</h2> <p>建立连接前，客户端和服务端需要通过握手来确认对方:</p> <ul><li>客户端发送 syn(同步序列编号) 请求，进入 syn_send 状态，等待确认</li> <li>服务端接收并确认 syn 包后发送 syn+ack 包，进入 syn_recv 状态</li> <li>客户端接收 syn+ack 包后，发送 ack 包，双方进入 established 状态</li></ul> <h2 id="tcp-四次挥手"><a href="#tcp-四次挥手" class="header-anchor">#</a> TCP 四次挥手</h2> <ul><li>客户端 -- FIN --&gt; 服务端， FIN—WAIT</li> <li>服务端 -- ACK --&gt; 客户端， CLOSE-WAIT</li> <li>服务端 -- ACK,FIN --&gt; 客户端， LAST-ACK</li> <li>客户端 -- ACK --&gt; 服务端，CLOSED</li></ul> <h2 id="解决无状态问题"><a href="#解决无状态问题" class="header-anchor">#</a> 解决无状态问题</h2> <p>HTTP 协议是无状态的，无状态意味着，服务器无法给不同的客户端响应不同的信息。这样一些交互业务就无法支撑了。</p> <h4 id="_1-cookie"><a href="#_1-cookie" class="header-anchor">#</a> 1. Cookie</h4> <p>cookie 的传递会经过下边这 4 步：</p> <ol><li>Client 发送 HTTP 请求给 Server</li> <li>Server 响应，并附带 Set-Cookie 的头部信息</li> <li>Client 保存 Cookie，之后请求 Server 会附带 Cookie 的头部信息</li> <li>Server 从 Cookie 知道 Client 是谁了，返回相应的响应</li></ol> <p>Server 拿到 Cookie 后，通过什么信息才能判断是哪个 Client 呢？服务器的 SessionID。</p> <h4 id="_2-session"><a href="#_2-session" class="header-anchor">#</a> 2. Session</h4> <p>如果把用户名、密码等重要隐私都存到客户端的 Cookie 中，还是有泄密风险。为了更安全，把机密信息保存到服务器上，这就是 Session。Session 是服务器上维护的客户档案，可以理解为服务器端数据库中有一张 user 表，里面存放了客户端的用户信息。SessionID 就是这张表的主键 ID。</p> <p>Session 信息存到服务器，必然占用内存。用户多了以后，开销必然增大。为了提高效率，需要做分布式，做负载均衡。因为认证的信息保存在内存中，用户访问哪台服务器，下次还得访问相同这台服务器才能拿到授权信息，这就限制了负载均衡的能力。而且 SeesionID 存在 Cookie，还是有暴露的风险，比如 CSRF(Cross-Site Request Forgery，跨站请求伪造)。</p> <p>如何解决这些问题呢？基于 Token 令牌鉴权。</p> <h4 id="_3-token"><a href="#_3-token" class="header-anchor">#</a> 3. Token</h4> <p>首先，Token 不需要再存储用户信息，节约了内存。其次，由于不存储信息，客户端访问不同的服务器也能进行鉴权，增强了扩展能力。然后，Token 可以采用不同的加密方式进行签名，提高了安全性。</p> <p>Token 就是一段字符串，Token 传递的过程跟 Cookie 类似，只是传递对象变成了 Token。用户使用用户名、密码请求服务器后，服务器就生成 Token，在响应中返给客户端，客户端再次请求时附带上 Token，服务器就用这个 Token 进行认证鉴权。</p> <p>Token 虽然很好的解决了 Session 的问题，但仍然不够完美。服务器在认证 Token 的时候，仍然需要去数据库查询认证信息做校验。为了不查库，直接认证，JWT 出现了。</p> <h4 id="_4-jwt"><a href="#_4-jwt" class="header-anchor">#</a> 4. JWT</h4> <p>JWT 的英文全称是 JSON Web Token。JWT 把所有信息都存在自己身上了，包括用户名密码、加密信息等，且以 JSON 对象存储的。</p> <p>JWT 长相是 xxxxx.yyyyy.zzzzz，极具艺术感。包括三部分内容</p> <ul><li>Header 包括 token 类型和加密算法(HMAC SHA256 RSA)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string-property property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;typ&quot;</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">}</span>
</code></pre></div><ul><li>Payload 传入内容</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span> <span class="token string-property property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234567890&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;admin&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
</code></pre></div><ul><li>Signature
签名，把 header 和 payload 用 base64 编码后&quot;.&quot;拼接，加盐 secret(服务器私钥)。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">HMACSHA256</span><span class="token punctuation">(</span><span class="token function">base64UrlEncode</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> <span class="token function">base64UrlEncode</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span>
</code></pre></div><p>最终的 token 就是这样一个字符串</p> <div class="language-js extra-class"><pre class="language-js"><code>eyJhbGciOiJIUzI1NiJ9
  <span class="token punctuation">.</span>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ
  <span class="token punctuation">.</span>yKOB4jkGWu7twu8Ts9zju01E10_CPedLJkoJFCan5J4
</code></pre></div><p>给 Token 穿个外套</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">Authorization</span><span class="token operator">:</span> Bearer
</code></pre></div><h2 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h2> <ul><li><p>JSONP: 利用 <code>&lt;script&gt;</code> 标签不受跨域限制的特点，缺点是只能支持 get 请求</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> jsonpCallback<span class="token punctuation">,</span> success</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url
  script<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token boolean">true</span>
  script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span>
  window<span class="token punctuation">[</span>jsonpCallback<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    success <span class="token operator">&amp;&amp;</span> <span class="token function">success</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>设置 CORS: Access-Control-Allow-Origin：*</p></li> <li><p>postMessage</p></li></ul> <h2 id="安全"><a href="#安全" class="header-anchor">#</a> 安全</h2> <ul><li>XSS: 跨站脚本攻击
<ul><li>cookie 设置 httpOnly, 禁止 JavaScript 读取某些敏感 Cookie</li> <li>转义页面上的输入内容和输出内容</li></ul></li> <li>CSRF: 跨站请求伪造，防护:
<ul><li>get 不修改数据</li> <li>不被第三方网站访问到用户的 cookie</li> <li>设置白名单，不被第三方网站请求</li> <li>请求校验</li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/18/2022, 5:42:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/summary/http/web.html" class="prev">
        浏览器
      </a></span> <span class="next"><a href="/summary/framework/vue.html">
        Vue
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.07d4e7d8.js" defer></script><script src="/assets/js/2.e756895e.js" defer></script><script src="/assets/js/29.d089321c.js" defer></script>
  </body>
</html>
